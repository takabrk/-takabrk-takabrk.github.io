
<!DOCTYPE html>

<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>5. Python Hacks &#8212; Valkyrie Linux Documentation 1.0.0 ドキュメント</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="6. PHP Hack" href="tech006.html" />
    <link rel="prev" title="4. JavaScript Hack" href="tech004.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="python-hacks">
<h1><span class="section-number">5. </span>Python Hacks<a class="headerlink" href="#python-hacks" title="このヘッドラインへのパーマリンク">¶</a></h1>
<section id="ubuntupythonpython3">
<h2><span class="section-number">5.1. </span>UbuntuでPythonのバージョンをPython3をメインにする<a class="headerlink" href="#ubuntupythonpython3" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Ubuntuでバージョンを切り替えるには、以下のコマンドを入力して実行を行えば良いでしょう。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">update</span><span class="o">-</span><span class="n">alternatives</span> <span class="o">--</span><span class="n">install</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python</span> <span class="n">python</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python2</span><span class="mf">.7</span> <span class="mi">1</span>
<span class="n">sudo</span> <span class="n">update</span><span class="o">-</span><span class="n">alternatives</span> <span class="o">--</span><span class="n">install</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python</span> <span class="n">python</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python3</span><span class="mf">.4</span> <span class="mi">2</span>
</pre></div>
</div>
<p>バージョンを切り替えたい場合には次のコマンドを実行します。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>sudo update-alternatives –config python
</pre></div>
</div>
</section>
<section id="python">
<h2><span class="section-number">5.2. </span>Pythonを使う際に便利なライブラリとテクニック<a class="headerlink" href="#python" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>◎Pythonドキュメント</p>
<p><a class="reference external" href="https://www.python.org/doc/">https://www.python.org/doc/</a></p>
<p>プログラミング言語「Python」の公式サイトに掲載されている言語ドキュメントです。</p>
<p>Pythonの文法は、非常に覚える事が少なくなっている一方で、ライブラリは非常に多いです。</p>
<p>まず、文法を理解する事が大切であり、使っていて忘れてしまった内容を思い出したい時に、このリファレンスを活用すれば便利です。</p>
<p>書籍を買わなくても、ここで大体の情報は得られるはずです。</p>
<p>◎Python2からPython3に移行したい</p>
<p><a class="reference external" href="http://docs.python.jp/2/library/2to3.html">http://docs.python.jp/2/library/2to3.html</a></p>
<p>Python3には、Python2からPython3に移行する為のツールを使う事で、取り敢えずは移行が可能です。</p>
<p>動作しない可能性もありますので、バックアップをとってから、このツールを使ってみると良いでしょう。</p>
<p>◎ブラウザでコードを試す事が出来るサービス</p>
<p><a class="reference external" href="https://paiza.io/">https://paiza.io/</a></p>
<p>このサービスは、Pythonを実行する環境が無くても、ブラウザ上でPythonのコードを試す事が出来ます。</p>
<p>ちょっとした思いつきでコードを試してみたい時に便利です。</p>
<p>◎機械学習</p>
<p><a class="reference external" href="http://scikit-learn.org/stable/">http://scikit-learn.org/stable/</a></p>
<p>Scikit Learnは、クラスタリングなどを行うのに必要な処理を一括して請け負ってくれるライブラリです。</p>
<p>ScipyやNumpyをベースに開発されており、必要な事が出来る定番ライブラリの一つです。</p>
<p><a class="reference external" href="http://www.deeplearning.net/software/theano/">http://www.deeplearning.net/software/theano/</a></p>
<p>Pythonでディープラーニングを行いたい時に使う定番のライブラリの一つです。</p>
<p>行列計算などが実装されていますので、高度な処理が可能です。</p>
<p><a class="reference external" href="https://www.tensorflow.org/">https://www.tensorflow.org/</a></p>
<p>Googleが開発したディープラーニング向けのライブラリ。</p>
<p>Theanoに次ぐディープラーニングライブラリとして人気があります。</p>
<p><a class="reference external" href="http://chainer.org/">http://chainer.org/</a></p>
<p>ニューラルネットワーク向けのライブラリです。</p>
<p><a class="reference external" href="http://pybrain.org/">http://pybrain.org/</a></p>
<p>ニューラルネットワークに強いライブラリ。</p>
<p><a class="reference external" href="http://pyml.sourceforge.net/">http://pyml.sourceforge.net/</a></p>
<p>SVM・再近傍法・リッジ回帰などが得意なライブラリ。</p>
<p><a class="reference external" href="http://deeplearning.net/software/pylearn2/">http://deeplearning.net/software/pylearn2/</a></p>
<p>画像の認識処理などをしたい時に役に立つライブラリ。</p>
<p>◎Get folder path from FileChooserButton in Python</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/31872243/get-folder-path-from-filechooserbutton-in-python">http://stackoverflow.com/questions/31872243/get-folder-path-from-filechooserbutton-in-python</a></p>
<p>◎Creating a Time-Lapse Camera with the Raspberry Pi and Python</p>
<p><a class="reference external" href="http://trevorappleton.blogspot.jp/2013/11/creating-time-lapse-camera-with.html">http://trevorappleton.blogspot.jp/2013/11/creating-time-lapse-camera-with.html</a></p>
<p>◎Python2とPython3が混ざっている環境で、Python3でスクリプトを動作させたい:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$python3 xxxx.py
</pre></div>
</div>
<p>pythonコマンドの代わりに、python3コマンドを使う。</p>
<p>◎Java環境向けの実行環境「Jython」</p>
<p><a class="reference external" href="http://www.jython.org/">http://www.jython.org/</a></p>
<p>スクリプトエンジンをJavaで開発されていて、Javaの代わりに使える言語で、Javaのライブラリを呼び出せます。</p>
<p>Processingにもモードがプラグインで提供されていて、Jythonの文法でプログラムを書く事が出来ます。</p>
<p>◎.NET環境向けの実行環境「Iron Python」</p>
<p><a class="reference external" href="http://ironpython.net/">http://ironpython.net/</a></p>
<p>.NET Framework環境で動作する、C#でスクリプトエンジンが開発された言語です。</p>
<p>C#の代わりに使える言語であり、.NET Framworkで提供されたAPIを呼び出して使う事が可能です。</p>
<p>◎Goで開発されたPython実行環境「Grumpy」</p>
<p><a class="reference external" href="https://github.com/google/grumpy">https://github.com/google/grumpy</a></p>
<p><a class="reference external" href="https://opensource.googleblog.com/2017/01/grumpy-go-running-python.html">https://opensource.googleblog.com/2017/01/grumpy-go-running-python.html</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Wednesday, January 4, 2017

Google runs millions of lines of Python code. The front-end server that drives youtube.com and YouTube’s APIs is primarily written in Python, and it serves millions of requests per second! YouTube’s front-end runs on CPython 2.7, so we’ve put a ton of work into improving the runtime and adapting our application to work optimally within it. These efforts have borne a lot of fruit over the years, but we always run up against the same issue: it&#39;s very difficult to make concurrent workloads perform well on CPython.
</pre></div>
</div>
<p>◎Pythonの高速化</p>
<p>◇JITコンパイラが実装された実行環境「PyPy」</p>
<p><a class="reference external" href="http://pypy.org/">http://pypy.org/</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>PyPy is a fast, compliant alternative implementation of the Python language (2.7.12 and 3.3.5). It has several advantages and distinct features:

Speed: thanks to its Just-in-Time compiler, Python programs often run faster on PyPy. (What is a JIT compiler?)

“If you want your code to run faster, you should probably just use PyPy.” — Guido van Rossum (creator of Python)

Memory usage: memory-hungry Python programs (several hundreds of MBs or more) might end up taking less space than they do in CPython.

Compatibility: PyPy is highly compatible with existing python code. It supports cffi and can run popular python libraries like twisted and django.

Stackless: PyPy comes by default with support for stackless mode, providing micro-threads for massive concurrency.

As well as other features.
</pre></div>
</div>
<p>Pythonで開発されたJITコンパイラを実装したスクリプトエンジンであり、CPythonよりも高速な処理を実現しているのが特徴です。</p>
<p>◇Cython</p>
<p><a class="reference external" href="http://cython.org/">http://cython.org/</a></p>
<blockquote>
<div><p>About Cython
Cython is an optimising static compiler for both the Python programming language and the extended Cython programming language (based on Pyrex). It makes writing C extensions for Python as easy as Python itself.
Cython gives you the combined power of Python and C to let you
write Python code that calls back and forth from and to C or C++ code natively at any point.
easily tune readable Python code into plain C performance by adding static type declarations.
use combined source code level debugging to find bugs in your Python, Cython and C code.
interact efficiently with large data sets, e.g. using multi-dimensional NumPy arrays.
quickly build your applications within the large, mature and widely used CPython ecosystem.
integrate natively with existing code and data from legacy, low-level or high-performance libraries and applications.
The Cython language is a superset of the Python language that additionally supports calling C functions and declaring C types on variables and class attributes. This allows the compiler to generate very efficient C code from Cython code. The C code is generated once and then compiles with all major C/C++ compilers in CPython 2.6, 2.7 (2.4+ with Cython 0.20.x) as well as 3.2 and all later versions. We regularly run integration tests against all supported CPython versions and their latest in-development branches to make sure that the generated code stays widely compatible and well adapted to each version. PyPy support is work in progress (on both sides) and is considered mostly usable since Cython 0.17. The latest PyPy version is always recommended here.
All of this makes Cython the ideal language for wrapping external C libraries, embedding CPython into existing applications, and for fast C modules that speed up the execution of Python code.</p>
</div></blockquote>
<p>C言語によるPython向けの拡張モジュールを作成するのに適した言語。</p>
<p>C言語の関数や変数の型やクラスの宣言などを使えるのが利点です。</p>
<p>Pythonの文法で型宣言などが出来るようになっていますので、C言語で一から作るよりも開発がしやすいというのが特徴です。</p>
<p>また、C言語のコードに変換してコンパイルを行いますので、コンパイルした物は、C言語のソースコードをコンパイルした物とほぼ同等レベルの速度で実行が可能になっています。</p>
<p>◎Python+シェルスクリプトでシェルスクリプトの弱点を補強する</p>
<p>シェルスクリプトはUNIX系のOSでファイル操作などのネイティブな処理が出来る為、Linuxなどを使っている場合には重宝するスクリプトシステムです。</p>
<p>しかし、このシェルスクリプトにも現代的な機能が無い場合があり、代表的な物としてはfor文があります。</p>
<p>近年では、Linuxのネイティブな機能操作を行う為の機構は、シェルスクリプトだけでなく、PythonやPerlやRubyなどの軽量言語があります。</p>
<p>軽量言語では、シェルスクリプトなどのOS特有の機能にアクセスする為のモジュールが用意されている事が多く、Pythonでは、osモジュールやshutilモジュールなどがあります。</p>
<p>これでシェルスクリプトをPythonスクリプトに埋め込み、Pythonとシェルスクリプトの良い部分を使って高度なプログラミングを行えるようになります。</p>
<p>簡単な例として、リストでアプリケーションの名称を保持し、Pythonのfor文とosモジュールとシェルスクリプトで纏めてインストールする場合にはこのように出来るでしょう。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">list1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;aaaa&quot;</span><span class="p">,</span><span class="s2">&quot;bbbb&quot;</span><span class="p">,</span><span class="s2">&quot;cccc&quot;</span><span class="p">,</span><span class="s2">&quot;dddd&quot;</span><span class="p">,</span><span class="s2">&quot;eeee&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">list1</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;sudo apt-get install </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
<p>これは、「sudo apt-get install aaaa bbbb cccc dddd eeee」と同義です。</p>
<p>しかし、リストlist1でアプリケーションの管理が出来ますので、変更したい時に変更しやすいといったメリットがあります。</p>
<p>Pyrhonとシェルスクリプトは、現在公開されているLinuxディストリビューションなどで装備されていますので、工夫をする事によって多彩な処理が出来るようになり、シェルスクリプトで用意されていないfor文を自在に使えるようになります。</p>
<p>os.systemは、Python2で使われていた方法であり、Python3になってからは、シェルスクリプトの呼び出しは、別のモジュールとメソッドを使う必要があります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">subprocess</span>

<span class="n">list1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;aaaa&quot;</span><span class="p">,</span><span class="s2">&quot;bbbb&quot;</span><span class="p">,</span><span class="s2">&quot;cccc&quot;</span><span class="p">,</span><span class="s2">&quot;dddd&quot;</span><span class="p">,</span><span class="s2">&quot;eeee&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">list1</span><span class="p">:</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s2">&quot;sudo apt-get install </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>os.systemの代わりに、subprocess.callを使います。</p>
<p>Pythonでシェルスクリプトを使う時に気をつけるべき事は、ディレクトリ移動です。</p>
<p>シェルスクリプトの場合には、「cd xxxx」で移動が出来ますが、これをPythonのos.systemに入れてしまいますと動作しません。</p>
<p>その代わり、osモジュールには、階層移動用のメソッドが用意されています。</p>
<p>Pythonでディレクトリ移動を行うには、「os.chdir(&quot;xxxx&quot;)」という風にしますと出来ます。</p>
<p>シェルスクリプトのmkdirは、Pythonでは「os.mkdir」を使います。</p>
<p>再帰的に階層を作りたい場合にはos.mkdirsを使えば良いでしょう。</p>
<p>権限を持っている人を変更するにはos.chown、モードを変更するには、os.chmodを使っていきます。</p>
<p>メソッドの名称は、比較的シェルスクリプトに準じていますので、どのような機能を持っているのかは分かりやすいでしょう。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;xxxx&quot;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="s2">&quot;yyyy&quot;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">chown</span><span class="p">(</span><span class="s2">&quot;zzzz&quot;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s2">&quot;aaaa&quot;</span><span class="p">)</span>

<span class="n">etc</span><span class="o">.</span>
</pre></div>
</div>
<p>◎Pythonのショートコード</p>
<p>1.forループの部分をリスト内包表記にする:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<p>これをリスト内包表記にすると以下のようになり、一行で書けるようになります。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
</pre></div>
</div>
<p>2.比較演算子の省略:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)]</span>
</pre></div>
</div>
<p>比較演算子を一つ減らすには以下のようにします。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)]</span>
</pre></div>
</div>
<p>3.三項演算子</p>
<p>JavaScriptでは、「変数 = 条件 ? 真 : 偽」というスタイルで三項演算子が使えましたが、Pythonでも書き方が少し違いますが三項演算子が使えます。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">b</span><span class="o">=</span><span class="mi">12</span>
<span class="k">if</span> <span class="n">a</span><span class="o">/</span><span class="n">b</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;False&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>三項演算子にすると以下の通りです。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">b</span><span class="o">=</span><span class="mi">12</span>
<span class="n">c</span> <span class="o">=</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span><span class="o">/</span><span class="n">b</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Flase&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>リスト内包表記と同じようにコードを一行で書きたい時に役立ちます。</p>
<p>4.Python2限定のreprリテラル</p>
<p>他のタイプから文字列に変更したい場合には、strメソッドを使いますが、Python2ではreprリテラルを使えます。</p>
<p>しかし、将来的にPython3に環境を移したい時にはreprリテラルを使わない方が良いでしょう。</p>
<p>reprリテラルは、Python3では削除されているからです。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span><span class="p">(</span><span class="mi">890</span><span class="p">)</span>
</pre></div>
</div>
<p>reprリテラルでは以下のように表現する事が出来ます。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`890`
</pre></div>
</div>
<p>5.モジュールを呼び出す時にエイリアスを使う</p>
<p>Pythonでは、モジュールを呼び出す時に、エイリアスを使う事でモジュールへのアクセスがしやすくなります。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>Numpyという数学モジュールを呼び出す時に、慣例になっている呼び出し方です。</p>
<p>Numpyのモジュールを使う時には、npでモジュールにアクセスして、Numpyのメソッドを使っていく事になります。</p>
<p>Python3でシェルスクリプトを使う時に利用する「subprocess.call」は、モジュール名が長いので、モジュールを呼び出す時にエイリアスを使っておけば、文字数を減らせるのが分かります。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">subprocess</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="n">sp</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s2">&quot;sudo apt-get install xfce4-terminal&quot;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>6.メソッドを使う時に変数に格納する</p>
<p>例えば、以下のコードがあるとします。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span>
<span class="bp">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="s2">&quot;button1&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>「self.tree.get_object」の部分が冗長的であり、このようなメソッドを何箇所も書く場合、面倒になります。</p>
<p>その為、この部分を変数に格納してしまえば、同じ処理を繰り返す時に入力するべき文字数が大幅に減らせます。</p>
<p>ブログラムもスッキリとしますので見易くなるでしょう。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Builder</span><span class="p">()</span>
<span class="n">treeObj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">get_object</span>
<span class="bp">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="n">treeObj</span><span class="p">(</span><span class="s2">&quot;button1&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>7.lambda式を使った関数のショートコード化</p>
<p>関数は、def文を使って複数行にわたって記述していく事になります。</p>
<p>以下は任意の数字iをn乗する関数です。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">square</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">i</span><span class="o">**</span><span class="n">n</span>
</pre></div>
</div>
<p>これをlambda式で表現しますと、以下のようになります。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">square</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="p">:</span><span class="n">i</span><span class="o">**</span><span class="n">n</span>
</pre></div>
</div>
<p>一行で表現する事が出来ました。</p>
<p>◎キャッシュ無しによるPIPを使ったライブラリのインストール法</p>
<p>PIPは、Pythonのパッケージ管理システムです。</p>
<p>通常「pip install xxx」というようにコマンド入力をして使いますが、この方法の場合、Wheelキャッシュが蓄積されたり、キャッシュに反応して新しいバージョンに上げる事が出来ない事があります。</p>
<p>キャッシュ無しでライブラリをインストールするには、以下のようにコマンド入力をします。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$sudo su
$pip install --no-cache-dir install -I xxx
</pre></div>
</div>
<p>◎PIPでインストールしたmatplotlibがエラーを出す</p>
<p>matplotlibをインポートするとエラーが出る時が度々あります。</p>
<p>対策としては以下のコマンドを実行してください。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$sudo su
#pip2 install numpy python-dateutil pytz pyparsing six --force-reinstall --upgrade --no-cache-dir
#pip3 install numpy python-dateutil pytz pyparsing six --force-reinstall --upgrade --no-cache-dir
</pre></div>
</div>
<p>◎【Python】ホームディレクトリの取得方法</p>
<p>Pythonでプログラムを書いていますと、ホームディレクトリに置いているファイルを読み書きしたい場合があります。その時に、Pythonでホームディレクトリを取得することが出来ます。以下がその方法です。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>import os
os.environ[‘HOME’]
</pre></div>
</div>
<p>「/home/xxx/.config」というパスを取得したい場合には、以下のようになります。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME’]+“/.config”</span>
</pre></div>
</div>
<p>◎BeautifulSoupを使ってHTMLファイルを辿っていく例</p>
<p>特定のURLのHTMLからthタグの値やtdタグの値を取得してリストrlaやrlbに入れる:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">BeautifulSoup</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="n">rla</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rlb</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
<span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">soup</span><span class="p">(</span><span class="s2">&quot;table&quot;</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">tbody</span> <span class="ow">in</span> <span class="n">table</span><span class="p">(</span><span class="s2">&quot;tbody&quot;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">tbody</span><span class="p">(</span><span class="s2">&quot;tr&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">tr</span><span class="p">(</span><span class="s2">&quot;th&quot;</span><span class="p">):</span>
                <span class="n">rla</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">renderContents</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">td</span> <span class="ow">in</span> <span class="n">tr</span><span class="p">(</span><span class="s2">&quot;td&quot;</span><span class="p">):</span>
                <span class="n">rlb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">td</span><span class="o">.</span><span class="n">renderContents</span><span class="p">())</span>
</pre></div>
</div>
<p>◎「&quot;0011&quot;,&quot;0021&quot;,&quot;0031&quot;・・・」というような数字のリストを作る例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sl</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;00&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;1&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
</pre></div>
</div>
<p>◎ネット上のHTMLを取得する例:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span><span class="nn">urllib2</span>
<span class="n">url_base</span> <span class="o">=</span> <span class="s2">&quot;http://xxx.com&quot;</span>
<span class="k">def</span> <span class="nf">download_html</span><span class="p">():</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;../&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
    <span class="n">nnum</span> <span class="o">=</span><span class="p">([</span><span class="s2">&quot;num&quot;</span><span class="o">+</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)])</span>
    <span class="nb">print</span> <span class="n">url_base</span>
    <span class="nb">print</span> <span class="n">nnum</span>
    <span class="n">opener</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">build_opener</span><span class="p">()</span>
    <span class="n">opener</span><span class="o">.</span><span class="n">addheaders</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;User-agent&#39;</span><span class="p">,</span><span class="s1">&#39;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.132 Safari/537.36&#39;</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nnum</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">=</span> <span class="n">opener</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url_base</span><span class="o">+</span><span class="s2">&quot;/</span><span class="si">%s</span><span class="s2">.html&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="nb">print</span> <span class="n">url_base</span><span class="o">/%</span><span class="n">s</span><span class="o">.</span><span class="n">html</span><span class="s2">&quot; % (i)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="s2">&quot;.html&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">lf</span><span class="p">:</span>
                <span class="n">lf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
            <span class="n">lf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span><span class="n">e</span><span class="p">:</span><span class="k">pass</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;../&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)]))</span>
</pre></div>
</div>
<p>◎テキストファイルの一部を書き換える例</p>
<p>xxx.txtというテキストファイルの中の一部分を書き換えます。 aaaは正規表現、bbbは書き換える内容です。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;xxx.txt&quot;</span><span class="p">)</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">fs</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;xxx.txt&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
    <span class="n">fs</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;aaa&quot;</span><span class="p">,</span><span class="s2">&quot;bbb&quot;</span><span class="p">,</span><span class="n">line</span><span class="p">)))</span>
    <span class="nb">print</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fs</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="ospython">
<h2><span class="section-number">5.3. </span>OSの情報をPythonでダイアログ表示させる方法<a class="headerlink" href="#ospython" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>OSの情報をPythonでダイアログ表示させるには、Tkとsubprocessモジュールを使えば、実現出来ます。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#-*- coding:utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">subprocess</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">tkMessageBox</span> <span class="k">as</span> <span class="nn">msb</span>

<span class="k">def</span> <span class="nf">information</span><span class="p">():</span>
    <span class="n">cmd1</span> <span class="o">=</span> <span class="s2">&quot;cat /etc/lsb-release&quot;</span>
    <span class="n">cmd2</span> <span class="o">=</span> <span class="s2">&quot;uname -r&quot;</span>
    <span class="n">ret1</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="n">cmd1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">))</span>
    <span class="n">ret2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="n">cmd2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">))</span>
    <span class="n">msb</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;About Valkyrie SRX&quot;</span><span class="p">,</span><span class="n">ret1</span><span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">ret2</span><span class="p">)</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">information</span><span class="p">()</span>
</pre></div>
</div>
<p>cmd1とcmd2は、シェルコマンドを入れておきます。シェルの出力結果を文字列として取得するのが、subprocess.check_outです。後は、tkMessageBox.showinfo を使ってダイアログ表示させます。</p>
</section>
<section id="id1">
<h2><span class="section-number">5.4. </span>並列処理で無名関数を使う<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><a class="reference external" href="http://stackoverflow.com/questions/35244577/is-it-possible-to-use-an-inline-function-in-a-thread-call">http://stackoverflow.com/questions/35244577/is-it-possible-to-use-an-inline-function-in-a-thread-call</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">You</span> <span class="n">can</span> <span class="n">use</span> <span class="n">a</span> <span class="k">lambda</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">Python</span> <span class="mf">3.</span><span class="n">x</span>

<span class="kn">import</span> <span class="nn">threading</span>

<span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello, </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">args</span><span class="o">=</span><span class="p">([</span><span class="s2">&quot;world&quot;</span><span class="p">]))</span>
<span class="n">You</span> <span class="n">should</span> <span class="n">probably</span> <span class="n">take</span> <span class="n">a</span> <span class="n">look</span> <span class="n">at</span> <span class="n">this</span> <span class="n">SO</span> <span class="n">question</span> <span class="n">to</span> <span class="n">see</span> <span class="n">why</span> <span class="n">you</span> <span class="n">can</span><span class="s1">&#39;t use print in Python 2.x in lambda expressions.</span>

<span class="n">Actually</span><span class="p">,</span> <span class="n">you</span> <span class="n">can</span> <span class="n">fit</span> <span class="n">many</span> <span class="n">function</span> <span class="n">calls</span> <span class="n">into</span> <span class="n">your</span> <span class="k">lambda</span><span class="p">:</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span> <span class="c1"># I&#39;m on Python 2.7</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>

<span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">That</span> <span class="n">will</span> <span class="nb">print</span> <span class="n">both</span> <span class="n">test</span> <span class="ow">and</span> <span class="n">hello</span><span class="o">.</span>
</pre></div>
</div>
<p>Pythonで数種類の処理を並列で行う場合に便利なモジュールがthreadingモジュールです。呼び出し方は以下のようになります。この場合は、Threadメソッドの呼び出しは「threading.Thread」となります。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">threading</span>
</pre></div>
</div>
<p>もし、プログラムの中で、Threadメソッドだけを記述したい場合には、以下のように呼び出します。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>
</pre></div>
</div>
<p>◇引数を用いる場合</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello, </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">args</span><span class="o">=</span><span class="p">([</span><span class="s2">&quot;world&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>引数aに与える値はargsで設定します。</p>
<dl>
<dt>◇引数を使わない場合</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="k">lambda</span> <span class="p">:</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s2">&quot;xxx&quot;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<p>subprocess.callなどでシェル経由でプログラムを動作させる場合に便利です。何れの場合も、工夫をすれば、一文で処理の設定が出来ます。</p>
</section>
<section id="pipmatplotlib">
<h2><span class="section-number">5.5. </span>PIP経由でmatplotlibをインストールしても可視化してくれない場合の対処法<a class="headerlink" href="#pipmatplotlib" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>matplotlibは、データを可視化してくれる便利なライブラリです。</p>
<p>しかし、PIP経由でインストールしてshowメソッドを使っても表示してくれない事があります。この原因は、matplotlibがpython-tkに依存している為ですので、python-tkをインストールしてからmatplotlibを再インストールすれば、可視化が出来るようになります。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$sudo apt-get install python-tk python3-tk

$sudo pip2 install --no-cache-dir -I matplotlib

$sudo pip3 install --no-cache-dir -I matplotlib
</pre></div>
</div>
</section>
<section id="pipstatsmodels">
<h2><span class="section-number">5.6. </span>PIP経由でstatsmodelsがインストールが出来ない時の対処法<a class="headerlink" href="#pipstatsmodels" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Pythonで線形回帰を行う時に便利なのがstatsmodelsというライブラリです。</p>
<p>しかし、PIPでインストールすると以下のようなエラーが出る事があります。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">statsmodels</span><span class="o">/</span><span class="n">nonparametric</span><span class="o">/</span><span class="n">_smoothers_lowess</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="mi">22</span><span class="p">:</span> <span class="n">fatal</span> <span class="n">error</span><span class="p">:</span> <span class="n">pyconfig</span><span class="o">.</span><span class="n">h</span><span class="p">:</span> <span class="n">そのようなファイルやディレクトリはありません</span>
<span class="n">compilation</span> <span class="n">terminated</span><span class="o">.</span>
<span class="n">error</span><span class="p">:</span> <span class="n">command</span> <span class="s1">&#39;x86_64-linux-gnu-gcc&#39;</span> <span class="n">failed</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">status</span> <span class="mi">1</span>

<span class="o">----------------------------------------</span>

 <span class="n">Command</span> <span class="s2">&quot;/usr/bin/python3 -u -c &quot;</span><span class="kn">import</span> <span class="nn">setuptools</span><span class="o">,</span> <span class="nn">tokenize</span><span class="p">;</span><span class="vm">__file__</span><span class="o">=</span><span class="s1">&#39;/tmp/pip-build-chrasx4k/statsmodels/setup.py&#39;</span><span class="p">;</span><span class="n">f</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">tokenize</span><span class="p">,</span> <span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="nb">open</span><span class="p">)(</span><span class="vm">__file__</span><span class="p">);</span><span class="n">code</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">();</span><span class="n">exec</span><span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="vm">__file__</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">))</span><span class="s2">&quot; install --record /tmp/pip-bbtim_8d-record/install-record.txt --single-version-externally-managed --compile&quot;</span> <span class="n">failed</span> <span class="k">with</span> <span class="n">error</span> <span class="n">code</span> <span class="mi">1</span> <span class="ow">in</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">pip</span><span class="o">-</span><span class="n">build</span><span class="o">-</span><span class="n">chrasx4k</span><span class="o">/</span><span class="n">statsmodels</span><span class="o">/</span>
</pre></div>
</div>
<p>GCCでコンパイルする時に必要な物が足りていないという事です。</p>
<p>必要な物は以下のコマンドでインストールする事が出来ます。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$sudo apt-get install python-dev python3-dev libxml2-dev libxslt-dev
</pre></div>
</div>
<p>これらのライブラリをインストールしてから、PIPでstatsmodelsをインストールすれば、使えるようになります。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$sudo pip2 install --no-cache-dir statsmodels

$sudo pip3 install --no-cache-dir statsmodels
</pre></div>
</div>
</section>
<section id="wsgicgi">
<h2><span class="section-number">5.7. </span>WSGIアプリケーションをCGIプログラムとして動作させる<a class="headerlink" href="#wsgicgi" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>WSGIは、Pythonにおいて、Javaのサーブレットのような仕組みを実現させるものです。PythonだけでWebサーバ経由でWSGIアプリケーションを動作させる事が可能であり、Apacheにmod_wsgiモジュールを組み込んでいれば、Apache上でWSGIアプリケーションが動作します。
一方で、サーバにはmod_wsgiが組み込まれていない事がありますので、代わりにCGIプログラムとしてWSGIアプリケーションとして動作させる事が出来ます。 以下のようなスクリプトファイルがあったとします。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#-*- coding:utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>

<span class="n">time</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">年</span><span class="si">%s</span><span class="s1">月</span><span class="si">%s</span><span class="s1">日 </span><span class="si">%s</span><span class="s1">時</span><span class="si">%s</span><span class="s1">分</span><span class="si">%s</span><span class="s1">秒</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">minute</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">second</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">application</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;200 OK&#39;</span>
    <span class="n">response_headers</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Content-type&#39;</span><span class="p">,</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">)]</span>
    <span class="n">start_response</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">response_headers</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">time</span><span class="p">]</span>
</pre></div>
</div>
<p>WSGIアプリケーションファイルの下部に以下の3行を付け加えます。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">wsgiref.handlers</span> <span class="kn">import</span> <span class="n">CGIHandler</span>
    <span class="n">CGIHandler</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">application</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="beautiful-souphtml">
<h2><span class="section-number">5.8. </span>Beautiful Soupを使ってHTMLを組み立てる<a class="headerlink" href="#beautiful-souphtml" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>PythonのHTMLパーサ「Beautiful Soup」を使ってHTMLを組み立ててみました。 Beautiful Soupが入っているフォルダは、PIPを使わずに、テストページと同じディレクトリに設置しています。 htmlタグやbodyタグなど基本的な要素は予めhtml変数に持たせています。 insertメソッドで要素を追加、Tag関数で追加したい要素の指定、NavigableStringで文字列の追加を行っています。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#-*- coding:utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span><span class="nn">sys</span><span class="o">,</span><span class="nn">urllib2</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span><span class="p">,</span><span class="n">Tag</span><span class="p">,</span><span class="n">NavigableString</span>

<span class="n">html</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span>
<span class="s2">&lt;html lang=&quot;ja&quot;&gt;</span>
<span class="s2">&lt;head&gt;</span>
<span class="s2">&lt;/head&gt;</span>
<span class="s2">&lt;body&gt;&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
<span class="n">soup</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;title&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;テストページ&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;style&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">body{</span>
<span class="s2">    background:#000000;</span>
<span class="s2">}</span>
<span class="s2">.baselayer{</span>
<span class="s2">    width:720px;</span>
<span class="s2">    height:600px;</span>
<span class="s2">    background:#ffffff;</span>
<span class="s2">    margin : 0 auto;</span>
<span class="s2">}</span>
<span class="s2">.test{</span>
<span class="s2">   width:100%;</span>
<span class="s2">   height:500px;</span>
<span class="s2">   margin:0;</span>
<span class="s2">   padding:0;</span>
<span class="s2">}</span>
<span class="s2">footer{</span>
<span class="s2">    background-color:#ff0000;</span>
<span class="s2">    height:100px;</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;div&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;baselayer&quot;</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;header&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;http://nightmare.osdn.jp&quot;</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;_blank&quot;</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;Top&quot;</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;nav&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;article&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;footer&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">footer</span><span class="o">.</span><span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;Copyright@taka&quot;</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">article</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;p&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;BeuatifulSoupを活用しています。&quot;</span><span class="p">))</span>

<span class="n">f</span><span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;test11.html&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">prettify</span><span class="p">())</span>
<span class="nb">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">prettify</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id2">
<h2><span class="section-number">5.9. </span>Pythonライブラリ/モジュール<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h2>
<blockquote>
<div><p><a class="reference external" href="http://www.pyglet.org/">Pyglet</a></p>
<p>画像・動画・音楽・音声を再生するために使用するモジュール</p>
<p><cite>Numpy &lt;http://www.numpy.org/&gt;</cite></p>
<p>数学を扱うためのライブラリ</p>
<p><a class="reference external" href="http://matplotlib.org/">matplotlib</a></p>
<p>グラフを扱うライブラリ。アニメーションさせることも出来る。</p>
<p><a class="reference external" href="http://www.pythonware.com/products/pil/">PIL(Python Imaging Library)</a></p>
<p>画像処理を行うライブラリ。フィルタを適用したり、トランスフォームを行うことが可能。</p>
</div></blockquote>
</section>
<section id="with">
<h2><span class="section-number">5.10. </span>withの使い方<a class="headerlink" href="#with" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;sample.txt&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;xxx&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>上のコードをwithは以下のような使い方をすることが可能です。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;samplle.txt&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
     <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;xxx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id3">
<h2><span class="section-number">5.11. </span>特定のキーを指定してリストをソートする<a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>以下のようなリストがあるとする。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tdata</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">)]</span>
</pre></div>
</div>
<p>これを各要素の二つ目の引数でソートをしたい場合は次のようにします。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tdata</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">cmp</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">cmp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
<p>降順にするには次のようにします。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tdata</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">cmp</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">cmp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>また、より簡単に高速にソートするには次のようにします。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">tdata</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="c1">#昇順</span>
<span class="nb">sorted</span><span class="p">(</span><span class="n">tdata</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>　<span class="c1">#降順</span>
</pre></div>
</div>
</section>
<section id="sqlitepython">
<h2><span class="section-number">5.12. </span>SQLiteで作成したテーブルのデータをPythonのリストにする方法<a class="headerlink" href="#sqlitepython" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>社員というテーブルに(名前,社員番号、年齢、社員ID)というインデックスを作ります。Pythonのsqlite3モジュールを使って作成してもいいですが、確実にデータベースを作成したいなら、GUI操作出来るソフトウェアの導入をお薦めします。
Firefoxには「sqlite-manager」というアドオンを使うとPHPのphpMyAdminのような操作でSQLiteで作成したデータベースのデータ管理がやりやすくなります。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="k">def</span> <span class="nf">db2file</span><span class="p">():</span>
     <span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;data.sqlite&quot;</span><span class="p">)</span>
     <span class="n">c</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
     <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from 社員&quot;</span><span class="p">)</span>
     <span class="n">kdata</span> <span class="o">=</span> <span class="p">[]</span>
     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
             <span class="n">kdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">kdata</span>
</pre></div>
</div>
<p>kdataの各要素はデータベースのデータがそのままタプルになっています。これでPythonでデータを操作出来ます。
もし、kdataの各要素を加工したい場合は以下のようにして各要素をリスト型にしてください。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kdata2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kdata</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id4">
<h2><span class="section-number">5.13. </span>数字の各桁の数字を算出する方法<a class="headerlink" href="#id4" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>数字の各桁の数字を算出するには以下のようにします。ここでは「3125」という数字があるとします。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3125</span><span class="o">/</span><span class="mi">1000</span> <span class="c1">#千の位</span>
<span class="mi">3125</span><span class="o">%</span><span class="mi">1000</span><span class="o">/</span><span class="mi">100</span> <span class="c1">#百の位</span>
<span class="mi">3125</span><span class="o">%</span><span class="mi">1000</span><span class="o">%</span><span class="mi">100</span><span class="o">/</span><span class="mi">10</span> <span class="c1">#十の位</span>
<span class="mi">3125</span><span class="o">%</span><span class="mi">1000</span><span class="o">%</span><span class="mi">100</span><span class="o">%</span><span class="mi">10</span> <span class="c1">#一の位</span>
</pre></div>
</div>
</section>
<section id="id5">
<h2><span class="section-number">5.14. </span>除法の結果で小数点の切り捨てを回避する方法<a class="headerlink" href="#id5" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Pythonでは除法を使うと、結果の小数点が切り捨てられます。これを回避したい場合（確率計算などをする場合など）は以下のようにします。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span>
<span class="mf">4.0</span><span class="o">/</span><span class="mi">100</span>
</pre></div>
</div>
<p>これらの結果は「0.04」となります。</p>
</section>
<section id="id6">
<h2><span class="section-number">5.15. </span>ループを使って各桁の組み合わせで数字を作る方法<a class="headerlink" href="#id6" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>百の位、十の位、一の位の各桁のリストがある場合、これらを使って3桁の数字のリストを作るには以下のようにします。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">num1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">num2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">num3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">numx</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">num1</span><span class="p">:</span>
     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">num2</span><span class="p">:</span>
             <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">num3</span><span class="p">:</span>
                     <span class="n">numx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">100</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id7">
<h2><span class="section-number">5.16. </span>確実にリストから要素を取り除く方法<a class="headerlink" href="#id7" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>ループ内でremoveメソッドなどでリストから要素を取り除くと「list out of range」などというエラーメッセージが出ることがあります。
これを回避するには以下のように書くとうまくいきます。
num1,num2というリストがあるとき、num2からnum1と同じ要素を取り除く場合、以下のようにtry～except文を使います。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">num1</span><span class="p">:</span>
     <span class="k">try</span><span class="p">:</span>
             <span class="n">num2</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
     <span class="k">except</span><span class="p">:</span><span class="n">num2</span>
</pre></div>
</div>
</section>
<section id="lambda">
<h2><span class="section-number">5.17. </span>1要素がタプルになっているリストをlambda式を使った降順にソートする<a class="headerlink" href="#lambda" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>unma = [(4,4),(3,1),(6,0),(5,3),(1,10),(2,3),(3,8)]を各タプルの第1項で降順ソートするには以下のようにします。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">unma</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">cmp</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">cmp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>また、第2項で降順ソートするには以下のようにします。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">unma</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">cmp</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">cmp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id8">
<h2><span class="section-number">5.18. </span>Pythonのバージョンを切り替える<a class="headerlink" href="#id8" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Pythonのバージョンを切り替えるには、「/usr/local/bin」の直下にあるpython-config,pythonを切り替えたいバージョンのシンボリックリンクに変更することで出来ます。元のPythonやpython-configは「/usr/bin」にあります。</p>
</section>
<section id="id9">
<h2><span class="section-number">5.19. </span>Pythonの標準関数を無効化するスクリプト<a class="headerlink" href="#id9" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>「__builtins__ = 0」と打ち込むだけで、Pythonの標準関数を無効化することが出来ます。</p>
<p>Pythonのリスト内包表記:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nums_mini</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">nc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nums_mini</span><span class="p">)):</span>
 <span class="n">nc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nums_mini</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">nums_mini</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
<p>これはnums_miniというリストの各要素の出現数を数え、空のリストncの中に加えていき、リストncを生成しています。これをリスト内包表記で表すと簡潔にすることが出来ます。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nc</span> <span class="o">=</span> <span class="p">[</span><span class="n">nums_mini</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">nums_mini</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nums_mini</span><span class="p">))]</span>
</pre></div>
</div>
<p>またループの中に条件をつけて条件に合致した場合に要素を取り出すときにもこのリスト内包表記で一行で表すことが出来ます。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">num_list</span><span class="p">)):</span>
 <span class="k">if</span> <span class="n">num_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">dc_num</span><span class="p">:</span>
  <span class="n">dc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
<p>これをリスト内包表記で表すと以下のようになります。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dc</span> <span class="o">=</span> <span class="p">[</span><span class="n">num_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">num_list</span><span class="p">))</span> <span class="k">if</span> <span class="n">num_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">dc_num</span><span class="p">]</span>
</pre></div>
</div>
<p>条件がfor文の後ろに来ています。ブロックを使う時には「:」を使いますが、リスト内包表記では省略することが出来ます。慣れると非常にコンパクトなスクリプトを書くことが出来るようになります。また、ループが入り子になっている場合は内包表記を使うと綺麗に表現することが出来ます。この時、リストのように改行しても問題ありません。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g3</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">una10</span><span class="p">)):</span>
     <span class="k">if</span> <span class="n">una10</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">g_num</span><span class="p">:</span>
             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
                     <span class="n">g3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">una10</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>

<span class="n">g3</span> <span class="o">=</span> <span class="p">[(</span><span class="n">una10</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
                                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">una10</span><span class="p">))</span>
                                 <span class="k">if</span> <span class="n">una10</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">g_num</span>
                                 <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</section>
<section id="processingjython">
<h2><span class="section-number">5.20. </span>ProcessingのプログラムをJythonに移植するためのテンプレート<a class="headerlink" href="#processingjython" title="このヘッドラインへのパーマリンク">¶</a></h2>
<blockquote>
<div><p>#Swingを読み込む
from javax.swing import JFrame
#Processingの「lib」フォルダにあるcoreライブラリを読み込む
from processing.core import PApplet</p>
<p>#クラスを設定
class Sketch(PApplet):</p>
<blockquote>
<div><dl class="simple">
<dt>def __init__(self):</dt><dd><p>pass</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>#空のフィールドを呼ぶ</dt><dd><dl class="simple">
<dt>def getField(self, name):</dt><dd><p>return self.class.superclass.getDe</p>
</dd>
</dl>
</dd>
</dl>
<p>claredField(name).get(self)</p>
<dl class="simple">
<dt>#Processingの「setup」部分を記述</dt><dd><dl class="simple">
<dt>def setup(self):</dt><dd><p>self.size(320, 240)</p>
</dd>
</dl>
</dd>
<dt>#Processingの「draw」部分を記述</dt><dd><p>def draw(self):</p>
</dd>
</dl>
<p>　　　　self.～
#アプレット実行関数
def run(applet):</p>
<blockquote>
<div><dl class="simple">
<dt>frame = JFrame(title=&quot;Processing&quot;,</dt><dd><p>resizable = 1,
defaultCloseOperation=JFrame.EXIT_ON_CLOSE)</p>
</dd>
</dl>
<p>frame.contentPane.add(applet)
applet.init()
frame.pack()
frame.visible = 1</p>
</div></blockquote>
<dl class="simple">
<dt>if __name__ == '__main__':</dt><dd><p>run(Sketch())</p>
</dd>
</dl>
</div></blockquote>
<p>ライブラリの呼び出し方はProcessingのJavaモードに準拠しているようです。後はJythonの文法でProcessingのプログラムを書いていくことが出来ます。Processingの関数には必ず「self」を追記する必要があります。また、事前にSwing、Processingのcoreライブラリを呼び出す必要があります。coreライブラリは環境変数のPathで関連付けておく必要があります。JythonファイルはShift-JISで保存してください。</p>
</section>
<section id="id10">
<h2><span class="section-number">5.21. </span>Beautiful Soupを使ってHTMLを組み立てる<a class="headerlink" href="#id10" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>PythonのHTMLパーサ「Beautiful Soup」を使ってHTMLを組み立ててみました。</p>
<p>Beautiful Soupが入っているフォルダは、PIPを使わずに、テストページと同じディレクトリに設置しています。</p>
<p>htmlタグやbodyタグなど基本的な要素は予めhtml変数に持たせています。</p>
<p>insertメソッドで要素を追加、Tag関数で追加したい要素の指定、NavigableStringで文字列の追加を行っています。:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#-*- coding:utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span><span class="nn">sys</span><span class="o">,</span><span class="nn">urllib2</span>
<span class="kn">from</span> <span class="nn">BeautifulSoup.BeautifulSoup</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span><span class="p">,</span><span class="n">Tag</span><span class="p">,</span><span class="n">NavigableString</span>

<span class="n">html</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&amp;lt;!DOCTYPE html&amp;gt;&lt;br&gt;&amp;lt;html lang=&quot;ja&quot;&amp;gt;&lt;br&gt;&amp;lt;head&amp;gt;&lt;br&gt;&amp;lt;/head&amp;gt;&lt;br&gt;&amp;lt;body&amp;gt;&amp;lt;/body&amp;gt;&lt;br&gt;&amp;lt;/html&amp;gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
<span class="n">soup</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;title&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;テストページ&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;style&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">body{</span>
<span class="s2">   background:#000000;</span>
<span class="s2">}</span>
<span class="s2">.baselayer{</span>
<span class="s2">   width:720px;</span>
<span class="s2">   height:600px;</span>
<span class="s2">   background:#ffffff;</span>
<span class="s2">   margin : 0 auto;</span>
<span class="s2">}</span>
<span class="s2">.test{</span>
<span class="s2">  width:100%;</span>
<span class="s2">  height:500px;</span>
<span class="s2">  margin:0;</span>
<span class="s2">  padding:0;</span>
<span class="s2">}</span>
<span class="s2">footer{</span>
<span class="s2">   background-color:#ff0000;</span>
<span class="s2">   height:100px;</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;div&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;baselayer&quot;</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;header&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;http://nightmare.osdn.jp&quot;</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;_blank&quot;</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;Top&quot;</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;nav&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;article&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;footer&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">footer</span><span class="o">.</span><span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;Copyright@taka&quot;</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">article</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Tag</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span><span class="s2">&quot;p&quot;</span><span class="p">))</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>
<span class="n">soup</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;BeuatifulSoupを活用しています。&quot;</span><span class="p">))</span>

<span class="n">f</span><span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;test11.html&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">prettify</span><span class="p">())</span>
<span class="nb">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">prettify</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Valkyrie Linux Documentation</a></h1>








<h3>ナビゲーション</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie001.html">1. Valkyrie Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie001.html#id6">2. インストール方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie001.html#boot-repair">3. Boot Repairの使い方</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie001.html#id7">4. セキュアブートの無効化</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie001.html#bit-osvalkyrie-linux">5. 64bit OS「Valkyrie Linux」の特長</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie001.html#id8">6. Valkyrie Linuxの高速化と最適化</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie001.html#id9">7. Valkyrie Linuxの高音質化</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie001.html#valkyrie-linuxgrub">8. Valkyrie Linuxのインストールの時にGRUBをインストールするのに失敗した場合の対処法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie002.html">9. コマンドランチャー「gmrun」の使い方</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie002.html#linuxi-o">10. 一時的にLinuxカーネルのI/Oスケジューラーを変更する方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie002.html#id1">11. サウンドサーバの切り替え</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie002.html#virtualbox">12. VirtualBoxの音の出し方</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie002.html#alsa">13. ALSAの音量設定の保存方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie002.html#pulseaudiojack-audio-connection-kit">14. PulseAudioとJack Audio Connection KItとの連携</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie002.html#amixer">15. amixerの設定コマンド</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie002.html#smplayer-mpv-youtube-dl1080p60fpsgpu">16. SMPlayer+MPV+youtube-dlで動画共有サイトの1080p60fps動画をGPUの動画支援機能で動作させる</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie002.html#betachromiumwidevinegoogle-api">17. Beta版ChromiumでWidevineとGoogle APIを使えるようにする</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie003.html">18. トラブルが起こった時の対処法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie004.html">19. カスタムカーネルについて</a></li>
<li class="toctree-l1"><a class="reference internal" href="../valkyrie/valkyrie020.html">20. 過去の履歴</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vipertools/vipertools001.html">1. Viper Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vipertools/vipertools002.html">2. viper.pyに引数を付け加えて機能を使う</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vipertools/vipertools003.html">3. viper.pyをPythonファイルにモジュールとして読み込ませる</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vipertools/vipertools003.html#viper">4. viperモジュールのクラス生成</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vipertools/vipertools003.html#id1">5. viperモジュールのメソッド</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vipertools/vipertools004.html">6. kyotei.pyのクラス生成</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vipertools/vipertools004.html#kyotei">7. kyoteiモジュールのメソッド</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vipertools/vipertools005.html">8. ナンバーズ予想用モジュール</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vipertools/vipertools005.html#download-data-py">9. download_data.pyのクラス生成</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vipertools/vipertools005.html#download-data">10. download_dataモジュールのメソッド</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vipertools/vipertools005.html#load-numbers-py">11. load_numbers.pyモジュールのクラス生成</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vipertools/vipertools005.html#numbers-py">12. numbers.pyモジュールのクラス生成</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../spiderjs/spiderjs001.html">1. spider.js</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spiderjs/spiderjs001.html#id4">2. メソッド</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tech001.html">1. Ubuntu系ディストリビューション向けテクニック</a></li>
<li class="toctree-l1"><a class="reference internal" href="tech002.html">2. CSS Hacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="tech003.html">3. Java Hacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="tech004.html">4. JavaScript Hack</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Python Hacks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ubuntupythonpython3">5.1. UbuntuでPythonのバージョンをPython3をメインにする</a></li>
<li class="toctree-l2"><a class="reference internal" href="#python">5.2. Pythonを使う際に便利なライブラリとテクニック</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ospython">5.3. OSの情報をPythonでダイアログ表示させる方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">5.4. 並列処理で無名関数を使う</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pipmatplotlib">5.5. PIP経由でmatplotlibをインストールしても可視化してくれない場合の対処法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pipstatsmodels">5.6. PIP経由でstatsmodelsがインストールが出来ない時の対処法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wsgicgi">5.7. WSGIアプリケーションをCGIプログラムとして動作させる</a></li>
<li class="toctree-l2"><a class="reference internal" href="#beautiful-souphtml">5.8. Beautiful Soupを使ってHTMLを組み立てる</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">5.9. Pythonライブラリ/モジュール</a></li>
<li class="toctree-l2"><a class="reference internal" href="#with">5.10. withの使い方</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">5.11. 特定のキーを指定してリストをソートする</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sqlitepython">5.12. SQLiteで作成したテーブルのデータをPythonのリストにする方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id4">5.13. 数字の各桁の数字を算出する方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">5.14. 除法の結果で小数点の切り捨てを回避する方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id6">5.15. ループを使って各桁の組み合わせで数字を作る方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id7">5.16. 確実にリストから要素を取り除く方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lambda">5.17. 1要素がタプルになっているリストをlambda式を使った降順にソートする</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id8">5.18. Pythonのバージョンを切り替える</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id9">5.19. Pythonの標準関数を無効化するスクリプト</a></li>
<li class="toctree-l2"><a class="reference internal" href="#processingjython">5.20. ProcessingのプログラムをJythonに移植するためのテンプレート</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id10">5.21. Beautiful Soupを使ってHTMLを組み立てる</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tech006.html">6. PHP Hack</a></li>
<li class="toctree-l1"><a class="reference internal" href="tech007.html">7. PlayOnLinux(Wine)で動作するソフトウェアまとめ</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="tech004.html" title="前の章へ"><span class="section-number">4. </span>JavaScript Hack</a></li>
      <li>Next: <a href="tech006.html" title="次の章へ"><span class="section-number">6. </span>PHP Hack</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="検索" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, takamitsu_h.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/tech/tech005.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>